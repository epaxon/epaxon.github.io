
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Linear classifiers and the kernel trick &#8212; Neuromorphic Algorithms Research</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Tutorials/vfa_kernel-rff-230420';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Classificaiton with high-order features" href="vfa_ho_class-230426.html" />
    <link rel="prev" title="Data classification and Vector Function Architectures" href="vsa_data_classifier.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/neural_circuit.png" class="logo__image only-light" alt="Neuromorphic Algorithms Research - Home"/>
    <script>document.write(`<img src="../_static/neural_circuit.png" class="logo__image only-dark" alt="Neuromorphic Algorithms Research - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Neuromorphic Algorithms Research
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About me</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about_me.html">E. Paxon Frady</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Research/neuroscience_data.html">Experimental Neuroscience</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Research/theoretical_neuroscience.html">Neural Computation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Research/sparse_binding_demo.html">Sparse binding demo – What’s the dollar of mexico?</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Research/spiking_networks.html">Spiking Neural Networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Research/tpam_demo.html">Threshold Phasor Associative Memory</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Research/resonator_networks.html">Resonator Networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Research/resonator_template.html">Factorization of shape, color and location</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Research/res_semi_primes-220216.html">Factoring semi-primes with the resonator network</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="computational_neuroscience.html">Computational Neuroscience</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spiking_basics_brian2.html">Rate-coding with Integrate-and-Fire neurons</a></li>
<li class="toctree-l2"><a class="reference internal" href="connecting_if_neurons.html">Connecting IFR theory to connectionism</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="vsa_data_classifier.html">Data classification and Vector Function Architectures</a><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Linear classifiers and the kernel trick</a></li>
<li class="toctree-l2"><a class="reference internal" href="vfa_ho_class-230426.html">Classificaiton with high-order features</a></li>
</ul><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Tutorials/vfa_kernel-rff-230420.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear classifiers and the kernel trick</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-classification">Linear classification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-kernel-trick-turning-distance-into-dot-product">The kernel trick: turning distance into dot product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-similar-are-vfa-and-rff">How similar are VFA and RFF?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continual-learning">Continual Learning?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vfa-encoding-with-sparse-block-codes">VFA encoding with sparse block codes</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="linear-classifiers-and-the-kernel-trick">
<h1>Linear classifiers and the kernel trick<a class="headerlink" href="#linear-classifiers-and-the-kernel-trick" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn.datasets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">warnings</span><span class="w"> </span><span class="kn">import</span> <span class="n">simplefilter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConvergenceWarning</span>
<span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">ConvergenceWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;font.serif&#39;</span><span class="p">:[</span><span class="s1">&#39;Computer Modern&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.fft</span><span class="w"> </span><span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">ifft</span>

<span class="k">def</span><span class="w"> </span><span class="nf">crvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">rphase</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">D</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rphase</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rphase</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">scvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">letter_vectors_c</span> <span class="o">=</span> <span class="n">crvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">K</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">letter_vectors_c</span><span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">ip</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        
    <span class="k">return</span> <span class="n">letter_vectors_c</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lccvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Kv</span><span class="p">):</span>
    <span class="c1"># N needs to be multiple of Kv</span>
    
    <span class="n">R</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="n">Kv</span>
    
    <span class="k">assert</span><span class="p">(</span><span class="n">R</span><span class="o">==</span><span class="n">N</span><span class="o">//</span><span class="n">Kv</span><span class="p">)</span>
    
    <span class="n">letter_vectors_c</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">crvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">R</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">Kv</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">ip</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Kv</span><span class="p">))</span>
        
        <span class="n">letter_vectors_c</span><span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">ip</span><span class="p">]</span> <span class="o">=</span> <span class="n">crvec</span><span class="p">(</span><span class="n">Kv</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">letter_vectors_c</span>
    
<span class="k">def</span><span class="w"> </span><span class="nf">cconv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">pa</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pb</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ifft</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="n">pa</span> <span class="o">*</span> <span class="n">fft</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="n">pb</span><span class="p">)</span>
    
<span class="k">def</span><span class="w"> </span><span class="nf">ccinv</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="c1">#return ifft(np.conj(fft(a)))</span>
    <span class="k">return</span> <span class="n">ifft</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lccI</span><span class="p">(</span><span class="n">Nv</span><span class="p">,</span> <span class="n">Kv</span><span class="p">):</span>
    <span class="n">vv</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">crvec</span><span class="p">(</span><span class="n">Nv</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
    
    <span class="n">Rv</span> <span class="o">=</span> <span class="n">Nv</span><span class="o">//</span><span class="n">Kv</span>
    
    <span class="n">vvr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Kv</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Rv</span><span class="p">)])</span>
    
    <span class="n">vvr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">return</span> <span class="n">vvr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>    
    
    

<span class="k">def</span><span class="w"> </span><span class="nf">lccbind</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">,</span> <span class="n">Kv</span><span class="p">,</span> <span class="n">pa</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pb</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Nv</span> <span class="o">=</span> <span class="n">vec1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Rv</span> <span class="o">=</span> <span class="n">Nv</span><span class="o">/</span><span class="n">Kv</span>

    <span class="n">vec1r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Kv</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Rv</span><span class="p">)])</span>
    <span class="n">vec2r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vec2</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Kv</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Rv</span><span class="p">)])</span>

    <span class="n">vec_br</span> <span class="o">=</span> <span class="n">cconv</span><span class="p">(</span><span class="n">vec1r</span><span class="p">,</span> <span class="n">vec2r</span><span class="p">,</span> <span class="n">pa</span><span class="p">,</span> <span class="n">pb</span><span class="p">)</span>

    <span class="n">vec_b</span> <span class="o">=</span> <span class="n">vec_br</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">vec_b</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lccperm</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">Kv</span><span class="p">,</span> <span class="n">proll</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Nv</span> <span class="o">=</span> <span class="n">vec1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Rv</span> <span class="o">=</span> <span class="n">Nv</span><span class="o">/</span><span class="n">Kv</span>

    <span class="n">vec1r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Kv</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Rv</span><span class="p">)])</span>
    
    <span class="n">vec_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">vec1r</span><span class="p">,</span> <span class="n">proll</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">vec_perm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lccinv</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">Kv</span><span class="p">):</span>
    <span class="n">Nv</span> <span class="o">=</span> <span class="n">vec1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Rv</span> <span class="o">=</span> <span class="n">Nv</span><span class="o">/</span><span class="n">Kv</span>

    <span class="n">vec1r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Kv</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Rv</span><span class="p">)])</span>
    
    <span class="n">vec1_ir</span> <span class="o">=</span> <span class="n">ccinv</span><span class="p">(</span><span class="n">vec1r</span><span class="p">)</span>
    <span class="n">vec1_i</span> <span class="o">=</span> <span class="n">vec1_ir</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">vec1_i</span>
</pre></div>
</div>
</div>
</div>
<section id="linear-classification">
<h2>Linear classification<a class="headerlink" href="#linear-classification" title="Link to this heading">#</a></h2>
<p>We start by considering some toy datasets in two-dimensions. For instance, we will create a classification problem using samples drawn from “blobs” – i.e. Gaussian distributed data with some center and variance.</p>
<p>For simple data like this, we can use linear separators to form classifiers. There are various ways to optimize the linear separators between classes, but fundamentally linear regresssion is the procedure that minimizes the error (based on euclidean distance) between the classifiers and the data.</p>
<p>This is of course supervised learning, where we need some training data. We will then formulate the training data as one-hot vectors of the three classes to set-up the problem in a way we can solve with linear regression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># number of data samples</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">22786</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x1074d33a0&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Font family [&#39;serif&#39;] not found. Falling back to DejaVu Sans.
findfont: Generic family &#39;serif&#39; not found because none of the following families were found: Computer Modern
</pre></div>
</div>
<img alt="../_images/d24045f0e4ce02276d61854a44a3e3003d63d933b36240dd257571881f89dffe.png" src="../_images/d24045f0e4ce02276d61854a44a3e3003d63d933b36240dd257571881f89dffe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_hot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y_hot</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Now we just form the least-squares estimate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_lstsq</span><span class="p">,</span><span class="n">resid</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y_hot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/xn/hqbqng2d6nz8f1lcyd545kqr0000gn/T/ipykernel_6970/2325016662.py:1: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  W_lstsq,resid,rank,sigma = np.linalg.lstsq(X,y_hot)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">)</span>

<span class="c1"># I just scaled the vectors by 100 for better visualization</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">W_lstsq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">W_lstsq</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">W_lstsq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">W_lstsq</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">W_lstsq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">W_lstsq</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x157955400&gt;]
</pre></div>
</div>
<img alt="../_images/ce675856a35218290cf36c9f9f77383af2a54209db8ba1d43aad39dab9b468b6.png" src="../_images/ce675856a35218290cf36c9f9f77383af2a54209db8ba1d43aad39dab9b468b6.png" />
</div>
</div>
<p>So the linear estimator finds vectors that point in the direction of the different classes. The higher the dot-product between the data-point and one of these vectors, then the more likely the data falls within the class. Then we can take the maximum amongst the three classes to make a decision about the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">class_lstsq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W_lstsq</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">kernel_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_samples</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">xv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_samples</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">yv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_samples</span><span class="p">):</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span><span class="p">],</span> <span class="n">W_lstsq</span><span class="p">))</span>
        <span class="n">kernel_image</span><span class="p">[</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc</span>
        
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1579a9d30&gt;
</pre></div>
</div>
<img alt="../_images/8f6e00015eeab743f20dc25185e80180230cc97310757afb52223e171b5c5e73.png" src="../_images/8f6e00015eeab743f20dc25185e80180230cc97310757afb52223e171b5c5e73.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">class_lstsq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x157876610&gt;
</pre></div>
</div>
<img alt="../_images/42b597cd0bc4f6ae50d64118edde471878d5e5a2e59235acb85b032ffea06e07.png" src="../_images/42b597cd0bc4f6ae50d64118edde471878d5e5a2e59235acb85b032ffea06e07.png" />
</div>
</div>
<p>So above we have visualized the entire space of the data points. Any data within a given region will lead to the same classification. These regions also extend indefinitely.</p>
<p>We can also give the linear separators the ability to extend from a point other than the origin by adding an extra parameter for the offset. This can be encapsulated by adding an extra dimension to the data matrix where every entry is always 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">Xb</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>

<span class="n">Wb_lstsq</span><span class="p">,</span><span class="n">resid</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span><span class="n">y_hot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/xn/hqbqng2d6nz8f1lcyd545kqr0000gn/T/ipykernel_6970/163325755.py:4: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  Wb_lstsq,resid,rank,sigma = np.linalg.lstsq(Xb,y_hot)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">kernel_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_samples</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">xv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_samples</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">yv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_samples</span><span class="p">):</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Wb_lstsq</span><span class="p">))</span>
        <span class="n">kernel_image</span><span class="p">[</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc</span>
        
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x157a62e80&gt;
</pre></div>
</div>
<img alt="../_images/3cfec8e8f9f03f44ac587af239c3592feb4f52e90fa9fefc5f9b7d8875583006.png" src="../_images/3cfec8e8f9f03f44ac587af239c3592feb4f52e90fa9fefc5f9b7d8875583006.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Wb_lstsq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.09742393, -0.02337258, -0.07405136],
       [ 0.05957096, -0.07294565,  0.01337469],
       [-0.0379745 ,  0.53883943,  0.49913507]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-kernel-trick-turning-distance-into-dot-product">
<h2>The kernel trick: turning distance into dot product<a class="headerlink" href="#the-kernel-trick-turning-distance-into-dot-product" title="Link to this heading">#</a></h2>
<p>One reason that conventional machine learning started with toy datasets like this, was because most of machine learning culture came from statistics and mathematics in the 80s and 90s. In this world, Gaussian distributions were extremely well understood and classification problems could be well formulated and objectively optimized – which mathematicians love!</p>
<p>Then there is a simple intuition when faced with a classification of this formulation. Since the likelihood of a sample is related to the distance to the mean of the distribution, then using the distance between samples as a metric for classification would seem to be a good idea.</p>
<p>Another thing mathematicians love are dot-products. In vector spaces, the dot-product is a very natural and common computation. Generally, when we use vector representations and feature spaces, we are relying on the notion of features being similar based on the dot-product of the feature vectors.</p>
<p>However, dot-products are linear operations. Many datasets, however, are not linearly separable, which means that the classes cannot be divided using a line (or plane or hyper-plane in higher dimensions).</p>
<p>So then for advancing data classification, mathematicians developed the “kernel trick”. This is a procedure to project the data into a higher dimensional space, based on higher-order features of the data. In this higher dimensional space, data classes can become separable by a linear classifier – assuming that you can find good higher order features.</p>
<p>Here, we see that the data is linearly separable, and so the linear classifier does a good job. Next, we will also go through the procedure of the kernel trick to demonstrate the idea.</p>
<p>However, there is generally a well-known computational issue with the kernel trick. The complexity grows quadratically with the number of data samples, which can become an issue. An important idea in the literature was put forward by Rahimi and Recht, 2007, which explains how kernels based on radial basis functions can be approximated.</p>
<p><a class="reference external" href="https://proceedings.neurips.cc/paper_files/paper/2007/file/013a006f03dbc5392effeb8f18fda755-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2007/file/013a006f03dbc5392effeb8f18fda755-Paper.pdf</a></p>
<p>In this case we are going to rely on the special properties of high-dimensional random vectors to approximate the kernel. In many cases, this can be much more computational or memory efficient.</p>
<p>We will start by first forming the Random Fourier Features of Rahimi and Rect. See also:
<a class="reference external" href="https://en.wikipedia.org/wiki/Radial_basis_function_kernel">https://en.wikipedia.org/wiki/Radial_basis_function_kernel</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># dimensionality</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># size of the kernel </span>
<span class="n">sidx</span> <span class="o">=</span> <span class="mi">22</span> <span class="c1"># index of sample to visualize</span>

<span class="c1"># Create the random fourier features</span>
<span class="n">Phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
<span class="c1"># you can just use cosine wave</span>
<span class="c1">#Z = np.sqrt(2/d)*np.cos(Phi.dot(X.T).T + b) </span>
<span class="c1"># but on closer inspection of Rahimi and Recht, 2007, they actually do use the complex definition. </span>
<span class="c1"># they just concatenate the cosine and sine waves</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="p">[:(</span><span class="n">d</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:(</span><span class="n">d</span><span class="o">//</span><span class="mi">2</span><span class="p">)][</span><span class="kc">None</span><span class="p">]),</span> 
                             <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Phi</span><span class="p">[:(</span><span class="n">d</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:(</span><span class="n">d</span><span class="o">//</span><span class="mi">2</span><span class="p">)][</span><span class="kc">None</span><span class="p">])))</span>
<span class="c1"># however, in their formulation they just concatenate the real and imag terms, but this is</span>
<span class="c1"># exactly like complex numbers. </span>

<span class="n">similarities</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">sidx</span><span class="p">,:])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">similarities</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x16947fbb0&gt;
</pre></div>
</div>
<img alt="../_images/7abd73d91d16b558b6194c4e62626c54e314d131ec2d414df46c2d8ba93b718f.png" src="../_images/7abd73d91d16b558b6194c4e62626c54e314d131ec2d414df46c2d8ba93b718f.png" />
</div>
</div>
<p>What we are visualizing in the figure above is the similarity between the random fourier features defined by each sample in the data set. Samples that are colored yellow/brighter are more similar to the target sample than the other samples in the data set.</p>
<p>So if we wanted to build a one-shot classifier, we could just compare the similarity of the learned sample to the new samples coming in. If the similarity is above threshold, then we would consider it as part of the same class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_thresh</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">same_class</span> <span class="o">=</span> <span class="n">similarities</span> <span class="o">&gt;</span> <span class="n">sim_thresh</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">same_class</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x169481ee0&gt;
</pre></div>
</div>
<img alt="../_images/c7ee8e637faa2a0e325ac3b6a4a5496e944fcba285522b3f56068ab7dc2cea2a.png" src="../_images/c7ee8e637faa2a0e325ac3b6a4a5496e944fcba285522b3f56068ab7dc2cea2a.png" />
</div>
</div>
<p>The yellow samples would all then be considered in the same class as the initial sample.</p>
<p>The random fourier features form a kernel space. The shape of the kernel is determined by the Bochner theorm. In essence, the probability distribution of the random features determines the exact shape of the kernel. The shape is computed through a Fourier transform, where in this example we used a Gaussian distribution of samples, which produces in the Fourier domain also a Gaussian distribution. So the kernel is the shape of a two-dimensional Guassian.</p>
<p>So lets try and visualize this. First, I’m just going to plot the similarities between the samples as a function of distance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="p">((</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">similarities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;BarContainer object of 300 artists&gt;
</pre></div>
</div>
<img alt="../_images/a02f7e9c875177c4e0507ec1c56c837fe855634809d143385be2ee3ea2f9aadd.png" src="../_images/a02f7e9c875177c4e0507ec1c56c837fe855634809d143385be2ee3ea2f9aadd.png" />
</div>
</div>
<p>So then we can start to see the shape of the kernel as sampled from the data.</p>
<p>Another way is to just brute-force our way through the entire space and sample the kernel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">kernel_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_samples</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">xv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_samples</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">yv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_samples</span><span class="p">):</span>
        <span class="n">s_rff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="n">yv</span><span class="p">,</span><span class="n">xv</span><span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">kernel_image</span><span class="p">[</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_rff</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span> <span class="p">:])</span>
        
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x169810ee0&gt;
</pre></div>
</div>
<img alt="../_images/1a3088839271a31a929b2247750bd199163d790cd8a589e034a317ec356d4bc0.png" src="../_images/1a3088839271a31a929b2247750bd199163d790cd8a589e034a317ec356d4bc0.png" />
</div>
</div>
<p>This is the two-dimensional Gaussian blob that defines the kernel. This kernel is translation invariant, and depending on the sample we chose it could appear in different locations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">same_class</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x169877580&gt;
</pre></div>
</div>
<img alt="../_images/5310b236a5b166aa738871bafdfa579f99a92c355db3520f7d655684f4053c1a.png" src="../_images/5310b236a5b166aa738871bafdfa579f99a92c355db3520f7d655684f4053c1a.png" />
</div>
</div>
<p>If we superpose the data on top of the kernel map we can get a clear sense of how the classification system works. The threshold defines a radius around the center of the kernel for which data samples would be in or out of class.</p>
</section>
<section id="how-similar-are-vfa-and-rff">
<h2>How similar are VFA and RFF?<a class="headerlink" href="#how-similar-are-vfa-and-rff" title="Link to this heading">#</a></h2>
<p>Now, the way we do this with what we call Vector Function Architectures is extremely close mathematically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create some random phasor vectors (uniform samples)</span>
<span class="n">vX</span> <span class="o">=</span> <span class="n">crvec</span><span class="p">(</span><span class="n">d</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vY</span> <span class="o">=</span> <span class="n">crvec</span><span class="p">(</span><span class="n">d</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">data_vecs</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">crvec</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">data_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vX</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">vY</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    
<span class="n">vfa_sims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">data_vecs</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">data_vecs</span><span class="p">[</span><span class="n">sidx</span><span class="p">,:])))</span><span class="o">/</span><span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">vfa_sims</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x169893700&gt;
</pre></div>
</div>
<img alt="../_images/bbbaab9dd8cfef7131837c100e68f44e63e4710d1357542d3dfbd000376f5790.png" src="../_images/bbbaab9dd8cfef7131837c100e68f44e63e4710d1357542d3dfbd000376f5790.png" />
</div>
</div>
<p>So, what we did here we like to call the “exponentiation trick”. We have started by drawing random VFA vectors vX and vY, which are vectors of unit magnitude complex numbers. The phases are distributed uniformly. Then we exponentiate the vectors proportional to the coordinates of the data samples. We can use the binding operation to create a code for each dimension. There is then a parameter that also determines the scale of the kernel, beta.</p>
<p>As you can see, the result looks very familiar. And if we dive into the mathematics we can clearly see why.</p>
<p>Basically, lets start by just noting that it is somewhat of a trivial step to link the cosine wave as described in Rahimi and Rect into a complex-valued wave.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>

<span class="c1"># Can do RFF with the complex numbers</span>
<span class="n">Zc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">+</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Phi</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="n">crff_sims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Zc</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">Zc</span><span class="p">[</span><span class="n">sidx</span><span class="p">,:])))</span><span class="o">/</span><span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># still has a similar kernel property</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">crff_sims</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x1699334f0&gt;
</pre></div>
</div>
<img alt="../_images/559171ca06f74f82a1c42b7c518f521d3c9043c422f8ac1824deea792acf3591.png" src="../_images/559171ca06f74f82a1c42b7c518f521d3c9043c422f8ac1824deea792acf3591.png" />
</div>
</div>
<p>Converting to complex space doesn’t really change the situation much.</p>
<p>(The dimensionality of the vector is perhaps larger, since there are now two complex values per entry. But since there is a free parameter that defines the dimensionality this is not really anything signficant.)</p>
<p>So we see that RFF could be written in complex form
$<span class="math notranslate nohighlight">\(
z_i = cos(\Phi_{i,x} x + \Phi_{i,y} y + b_i) + \textrm{i} sin(\Phi_{i,x} x + \Phi_{i,y} y + b_i)
\)</span>$</p>
<p>and the values <span class="math notranslate nohighlight">\(\Phi_{i,x} \sim \mathcal{N}(0, \sigma)\)</span> are random gaussian values.</p>
<p>So, then we can rewrite this:
$<span class="math notranslate nohighlight">\(
z_i = e^{\textrm{i} (\Phi_{i,x} x +\Phi_{i,y} y + b_i)} = e^{\textrm{i} \Phi_{i,x} x} e^{\textrm{i} \Phi_{i,y} y} e^{\textrm{i} b_i} 
\)</span>$</p>
<p>So then here is exactly VFA. When adjusted to complex space, the formulation of Rahimi and Rect is exactly the exponentiation trick in VFA.</p>
<p>The only difference left is that what VFA started with was the random vales of <span class="math notranslate nohighlight">\(\Phi\)</span> are uniform rather than Gaussian. But as we describe in the VFA paper, it is the probability distribution of these random features that define the shape of the kernel. Gaussian distributions give Gaussian kernels, Uniform distributions give a kernel in the shape of the sinc function.</p>
<p>The extra <span class="math notranslate nohighlight">\(e^{\textrm{i} b_i}\)</span> factor doesn’t really do much. I like to think of this as a simple change in reference frame from the VFA perspective.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">kernel_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_samples</span><span class="p">))</span>

<span class="n">center_vec</span> <span class="o">=</span> <span class="n">vX</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">vY</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">xv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_samples</span><span class="p">):</span>
    <span class="n">vv</span> <span class="o">=</span> <span class="n">vX</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">xv</span><span class="p">)</span> <span class="o">*</span> <span class="n">vY</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">kernel_1d</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">center_vec</span><span class="p">),</span> <span class="n">vv</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_samples</span><span class="p">,</span> <span class="n">kernel_1d</span><span class="p">)</span>
<span class="c1"># The kernel is the sinc function!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_samples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">x_samples</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span> <span class="s1">&#39;:r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x16998e4c0&gt;]
</pre></div>
</div>
<img alt="../_images/5f933a6034d23caa50f2387b237e3bfe2020fcb0a23fa8d51954718c41ba30ea.png" src="../_images/5f933a6034d23caa50f2387b237e3bfe2020fcb0a23fa8d51954718c41ba30ea.png" />
</div>
</div>
<p>So you can see that the shape of the kernel is in fact the sinc function, which is a very special and important function in signal processing. This is simply what happens when the sample distribution is uniform rather than Gaussian.</p>
<p>We can visualize the full two-dimensional sinc function as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">kernel_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_samples</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">xv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_samples</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">yv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_samples</span><span class="p">):</span>
        
        <span class="n">vv</span> <span class="o">=</span> <span class="n">vX</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">xv</span><span class="p">)</span> <span class="o">*</span> <span class="n">vY</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">yv</span><span class="p">)</span>
        
        <span class="n">kernel_image</span><span class="p">[</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">center_vec</span><span class="p">),</span> <span class="n">vv</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1699e5a60&gt;
</pre></div>
</div>
<img alt="../_images/9b2ced431314a08168915f3d7833832ae55d48a5c70e597d7f4a81e4008fdd47.png" src="../_images/9b2ced431314a08168915f3d7833832ae55d48a5c70e597d7f4a81e4008fdd47.png" />
</div>
</div>
<p>Even though this is the sinc kernel, it still has a pretty decent ability to be used as part of a simple one-shot classifier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_thresh</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">vfa_same</span> <span class="o">=</span> <span class="n">vfa_sims</span> <span class="o">&gt;</span> <span class="n">sim_thresh</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">vfa_same</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x169a41be0&gt;
</pre></div>
</div>
<img alt="../_images/4cf1fefc9762652b6be62bd65d8d1c22bce6bc0736b9a64850b8b593e99e9b29.png" src="../_images/4cf1fefc9762652b6be62bd65d8d1c22bce6bc0736b9a64850b8b593e99e9b29.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">vfa_same</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x169aae5b0&gt;
</pre></div>
</div>
<img alt="../_images/88811adbe50fe5b2db5840a90aab570eb98a75b720eca4bc975e485cfc5e4980.png" src="../_images/88811adbe50fe5b2db5840a90aab570eb98a75b720eca4bc975e485cfc5e4980.png" />
</div>
</div>
<p>Of course, again we have a free parameter beta that determines the scale of the sinc function/kernel. By hand tuning this scale, we have performed feature engineering.</p>
</section>
<section id="continual-learning">
<h2>Continual Learning?<a class="headerlink" href="#continual-learning" title="Link to this heading">#</a></h2>
<p>Lets try to do some continual learning.</p>
<p>We will formulate a simple algorithm. If a new data point comes in and is close to one of the classifiers, then we add that data to the class. If there are no matches, we will just allocate a new neuron and a new class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">class_thresh</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="n">max_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">classifier_W</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">crvec</span><span class="p">(</span><span class="n">max_classes</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="n">next_new_class</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">class_plasticity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">max_classes</span><span class="p">)</span>

<span class="n">sims_hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_classes</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">xv</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">ix</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">yv</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">ix</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="n">vv</span> <span class="o">=</span> <span class="n">vX</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">xv</span><span class="p">)</span> <span class="o">*</span> <span class="n">vY</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">yv</span><span class="p">)</span>
    
    <span class="n">sims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">classifier_W</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">vv</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span>
    
    <span class="n">sims_hist</span><span class="p">[</span><span class="n">ix</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">sims</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">sims</span> <span class="o">&lt;</span> <span class="n">class_thresh</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span> <span class="s2">&quot;: new class&quot;</span><span class="p">)</span>
        <span class="n">classifier_W</span><span class="p">[</span><span class="n">next_new_class</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">vv</span>
        <span class="n">class_plasticity</span><span class="p">[</span><span class="n">next_new_class</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="n">next_new_class</span> <span class="o">+=</span> <span class="mi">1</span> 
        <span class="k">if</span> <span class="n">next_new_class</span> <span class="o">&gt;=</span> <span class="n">max_classes</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max class exceeded&quot;</span><span class="p">)</span>
            <span class="n">next_new_class</span> <span class="o">=</span> <span class="mi">0</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">win_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sims</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">xv</span><span class="p">,</span> <span class="n">yv</span><span class="p">,</span><span class="s2">&quot;: update class&quot;</span><span class="p">,</span> <span class="n">win_idx</span><span class="p">)</span>
        
        <span class="n">classifier_W</span><span class="p">[</span><span class="n">win_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vv</span> <span class="o">+</span> <span class="n">class_plasticity</span><span class="p">[</span><span class="n">win_idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">classifier_W</span><span class="p">[</span><span class="n">win_idx</span><span class="p">,</span> <span class="p">:])</span> \
                            <span class="o">/</span> <span class="p">(</span><span class="n">class_plasticity</span><span class="p">[</span><span class="n">win_idx</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">class_plasticity</span><span class="p">[</span><span class="n">win_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 -5.764894737303341 10.886201315179145 : new class
1 -3.042537062140443 8.721273861063748 : update class 0
2 -4.930615562342518 9.488514135323262 : update class 0
3 8.174394408668864 5.926392397742341 : new class
4 7.141873609906648 5.3791767640389985 : update class 1
5 7.110493306121051 4.2495430811135275 : update class 1
6 -4.412990401697481 9.550136155889136 : update class 0
7 -3.991750185125256 10.26435638537659 : update class 0
8 -5.969819164423003 9.118270228347109 : update class 0
9 6.8659657343586336 6.082993866005502 : update class 1
10 6.441639310924826 3.9666793447188073 : update class 1
11 5.85497917977676 -5.076678846373792 : new class
12 4.714796613922022 -7.481361772155762 : update class 2
13 2.3090880758078565 -6.684072854104022 : update class 2
14 8.881220868553038 6.014287277412546 : update class 1
15 5.191690866057043 -8.05118421485339 : update class 2
16 -3.942312168279632 9.069450758295584 : update class 0
17 -5.803040201876281 8.872638596223503 : update class 0
18 5.539792085451176 -8.211322077328703 : update class 2
19 -4.322734139936605 8.720732758431804 : update class 0
20 -4.6319233912491375 10.299630098094918 : update class 0
21 -5.105116417516664 7.949536440729258 : update class 0
22 7.233979435424574 5.892290710704061 : update class 1
23 -4.461531300172195 8.682513140678441 : update class 0
24 -5.591380585738682 9.364332533625165 : update class 0
25 6.1830031959569824 4.437695891435157 : update class 1
26 4.143573964578817 -9.08840354223392 : update class 2
27 4.967092190069724 -8.792280133461519 : update class 2
28 -4.8068039131529625 9.585273586485425 : update class 0
29 7.651066395006111 4.34499985849667 : update class 1
30 7.492979847886656 6.064665537086517 : update class 1
31 5.329328878318953 -8.732285836032398 : update class 2
32 3.8334313347230733 -7.947943186078524 : update class 2
33 6.908914416931428 4.372240682459866 : update class 1
34 -5.80211860842672 9.788696791101874 : update class 0
35 -5.183400832315178 10.6100543127012 : update class 0
36 4.8624111427106875 -7.466982594834854 : update class 2
37 4.668521673563483 -7.730873794101438 : update class 2
38 8.233488079007824 4.275903583604471 : update class 1
39 5.947555546140286 6.458976233157036 : update class 1
40 8.005355922838667 6.080397763319356 : update class 1
41 7.920683573354346 3.907854842962899 : update class 1
42 5.489446877944751 -7.736973620076722 : update class 2
43 5.799902899288071 -6.559722159160623 : update class 2
44 5.364942406177034 -7.140419952165079 : update class 2
45 4.032345025327588 -6.550120162031729 : update class 2
46 5.50683200097105 -7.948558076952613 : update class 2
47 5.147134800826444 -9.119100446122207 : update class 2
48 5.517819138806019 -6.9665756510338355 : update class 2
49 6.810628591044589 5.523194058084401 : update class 1
50 -5.893249645291049 7.915788448846219 : update class 0
51 5.975200616090086 4.322204183130116 : update class 1
52 7.322468470667113 3.755299591447507 : update class 1
53 6.776159251631896 2.8128902260133613 : update class 1
54 7.4757968287300995 5.369468396255316 : update class 1
55 -4.587676975646371 10.336931640361165 : update class 0
56 -6.569024041355299 8.056463390417191 : update class 0
57 7.242776773197225 -7.838996966907388 : update class 2
58 -3.0252144827944427 9.058620281564725 : update class 0
59 7.067716421691626 2.68247198823621 : update class 1
60 6.343665973820151 -5.79597950423855 : update class 2
61 6.932221334508496 5.4487384209040615 : update class 1
62 7.880436561728777 4.6343073699943815 : update class 1
63 8.084501478338948 3.2924934085049884 : update class 1
64 -6.330664396689847 9.38185827815301 : update class 0
65 4.116192365343134 -10.250302117353124 : update class 2
66 5.027961630223074 -9.838703866658363 : update class 2
67 4.613944149550634 -8.528401863677512 : update class 2
68 7.596585444777528 -8.553332002637328 : update class 2
69 -4.786539045628399 10.207219789473463 : update class 0
70 6.0277940103361685 -8.582556499773059 : update class 2
71 8.723829381378946 5.959488007372331 : update class 1
72 -4.875663270169359 8.891443207465032 : update class 0
73 6.140661554025508 4.206627972570851 : update class 1
74 7.358528250695854 4.684981505181402 : update class 1
75 -6.585853535286883 8.184300065596787 : update class 0
76 4.801753078805187 -7.717695785395874 : update class 2
77 4.9766658966134685 -6.281267642038958 : update class 2
78 -5.380295085383847 7.996652442679926 : update class 0
79 4.912636817256877 -6.991504297282697 : update class 2
80 -3.523758419043266 9.77765694876675 : update class 0
81 4.711218971939974 -7.610534153023118 : update class 2
82 7.999826659580755 4.542378237050913 : update class 1
83 6.569239432428643 -7.438995348003236 : update class 2
84 8.682759635035902 5.168832660409363 : update class 1
85 -3.9528059295747386 8.359792976095319 : update class 0
86 -5.270629914094979 8.82258345398748 : update class 0
87 3.9213210924160005 -7.423376079299397 : update class 2
88 7.129668571897947 5.785516063193106 : update class 1
89 4.091363303068301 -5.493252294576315 : update class 2
90 5.783662171488155 -9.128742196254269 : update class 2
91 6.32400671159449 -6.217431550777798 : update class 2
92 -4.801669163981563 8.125614753673407 : update class 0
93 10.272081016452209 4.2506187973630185 : update class 1
94 -4.742524359148182 8.978690792785416 : update class 0
95 6.151685838843708 -6.8559317825598844 : update class 2
96 7.2196093994629775 6.05276628387209 : update class 1
97 -3.9701520619467328 9.197585908652064 : update class 0
98 -5.386931577350657 9.730662743401323 : update class 0
99 5.133351013652157 -7.88245025129122 : update class 2
100 -5.243561846836388 9.74163819262337 : update class 0
101 4.106869317123208 -7.722565029210923 : update class 2
102 6.62950949551469 -6.651245455230932 : update class 2
103 -7.125499725001697 7.594711319032338 : update class 0
104 -4.373943231527212 8.036393783030825 : update class 0
105 4.357403731414575 -6.108004654801496 : update class 2
106 7.446091195487375 5.188108591228884 : update class 1
107 7.152241829599858 2.829637578983897 : update class 1
108 -5.173481019098046 10.400421876919607 : update class 0
109 7.5938518733184805 6.111922750946415 : update class 1
110 7.039086061280176 4.104800877426379 : update class 1
111 7.797187695888552 6.670362798799884 : update class 1
112 7.184693597472188 -8.584687295925162 : update class 2
113 5.752026159560998 5.135918015655399 : update class 1
114 7.515521191926663 -8.040573151300755 : update class 2
115 -4.423042745332896 9.527762332838602 : update class 0
116 4.271814818139249 -9.461327561785318 : update class 2
117 -3.4538950103578108 7.817485867593019 : update class 0
118 -5.126442987353774 8.285801287765251 : update class 0
119 7.81669641006858 5.467206385671759 : update class 1
120 -3.870127265062939 8.750123320706269 : update class 0
121 7.570734872881179 4.546864910993475 : update class 1
122 6.345524479633671 -7.827634113926062 : update class 2
123 7.005520047388472 4.807826055142213 : update class 1
124 6.49743971120072 4.675684993525953 : update class 1
125 -4.716049787185585 7.300747710380526 : update class 0
126 -3.3131205676485838 8.898086766322102 : update class 0
127 7.31754187826863 4.499719178943191 : update class 1
128 4.6871867210875084 -7.366063059060946 : update class 2
129 3.564062478434514 -8.764193349604598 : update class 2
130 6.596665725128045 4.060843098641632 : update class 1
131 6.844720340551568 4.182858960265597 : update class 1
132 4.9859318150671434 -7.440302647027837 : update class 2
133 -6.498336909851393 7.413601005295872 : update class 0
134 5.248551206550037 -7.874637458705296 : update class 2
135 -5.3171056893218065 10.197254535543985 : update class 0
136 5.7096706440779545 3.9678585295954796 : update class 1
137 -5.073333200735935 8.458925407759489 : update class 0
138 6.851075096234596 -7.624308044174402 : update class 2
139 7.437523510003332 5.790487744939238 : update class 1
140 -6.441983245400461 8.033243404519276 : update class 0
141 -3.944580993685742 9.621904088247895 : update class 0
142 7.203567820226506 3.7737937739277982 : update class 1
143 -3.792785906060303 10.592558746224409 : update class 0
144 7.941926261275802 4.8092906521241625 : update class 1
145 5.406813875746978 -8.952206522733823 : update class 2
146 -4.723621371392968 8.739344436766048 : update class 0
147 5.87489919460413 -7.207388845859651 : update class 2
148 -3.3569501679156835 8.68116249211365 : update class 0
149 6.3280798065225925 -8.589851294061173 : update class 2
150 5.057437373131301 -8.117435282247733 : update class 2
151 6.182809360311372 -7.087360150447078 : update class 2
152 9.538722965688297 5.441645936191501 : update class 1
153 6.119497063316601 -9.10392675537769 : update class 2
154 4.574419472566624 -8.425478882443553 : update class 2
155 -7.216850397945766 7.666899714446398 : update class 0
156 6.610255480938336 5.036366762025034 : update class 1
157 6.235442772944987 -7.519046037465522 : update class 2
158 4.701576772890984 -7.226695520895183 : update class 2
159 6.391317921585706 4.304601585881341 : update class 1
160 -5.254042197973291 9.364300211876921 : update class 0
161 8.380861403687724 3.4792972771431216 : update class 1
162 -4.857950767798167 9.60178092195859 : update class 0
163 -5.558115483462568 8.938108354918684 : update class 0
164 -3.0204952678418815 9.619128433561974 : update class 0
165 6.787055121317523 4.594979678958301 : update class 1
166 9.663208180725615 3.9974266521789277 : update class 1
167 7.262836347659691 6.5388068147369225 : update class 1
168 4.830739142646019 -9.13860287383442 : update class 2
169 5.77562002993626 -8.260331533697386 : update class 2
170 5.972551592022647 5.143759082257877 : update class 1
171 -4.627429181080706 8.249440176199395 : update class 0
172 7.087059440423105 5.387227496609433 : update class 1
173 5.117516341794608 -7.770867673904731 : update class 2
174 -5.28706727524286 8.854724370290278 : update class 0
175 5.246829105776046 -7.187620789457839 : update class 2
176 6.7845312569069405 3.652335318793268 : update class 1
177 -3.179756073413562 8.936046962798487 : update class 0
178 7.330175032270935 2.9458425724799953 : update class 1
179 6.711647262298351 2.84263538154557 : update class 1
180 -4.913637964328368 8.37313453631637 : update class 0
181 6.108281403921386 3.948876161345252 : update class 1
182 8.530240545781899 4.52125001905577 : update class 1
183 7.1643103193861615 3.7692807459892803 : update class 1
184 8.160756134528329 5.738954303718598 : update class 1
185 5.454451412416687 -9.716508744126394 : update class 2
186 3.4337163761310725 -5.574524980144866 : update class 2
187 9.808120173904427 5.2550826374535955 : update class 1
188 -5.236656839924985 8.93093653097767 : update class 0
189 -5.654673871862793 9.039265599060133 : update class 0
190 5.94567872015871 -7.407370225277187 : update class 2
191 5.635602325028995 7.673790778448257 : update class 1
192 -5.427201040731899 8.841676833166238 : update class 0
193 -4.263102176220831 9.194007128084372 : update class 0
194 -5.216863421178386 10.328333942065699 : update class 0
195 7.468800816791363 4.863502788933641 : update class 1
196 -5.445413026784006 9.859569952004192 : update class 0
197 4.681704485650912 -5.618405174167467 : update class 2
198 7.878525451626313 5.085311496552744 : update class 1
199 7.706704760701641 3.406832050392306 : update class 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">y_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">40</span><span class="p">)</span>

<span class="n">kernel_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_samples</span><span class="p">)))</span>

<span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">show_weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="c1">#show_weights = [0, 1, 2, 3, 4, 5, 6, 7]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">show_weights</span><span class="p">)):</span>
    <span class="n">class_result</span> <span class="o">=</span> <span class="n">classifier_W</span><span class="p">[</span><span class="n">show_weights</span><span class="p">[</span><span class="n">c</span><span class="p">],:]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">show_weights</span><span class="p">),</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">xv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_samples</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">yv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_samples</span><span class="p">):</span>

            <span class="n">vv</span> <span class="o">=</span> <span class="n">vX</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">xv</span><span class="p">)</span> <span class="o">*</span> <span class="n">vY</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">yv</span><span class="p">)</span>

            <span class="n">kernel_image</span><span class="p">[</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">class_result</span><span class="p">),</span> <span class="n">vv</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span>    
    
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6d56b8907f7ce78a3421b48c4e892f0aa5f7f14c989b33545109453d5aa4f138.png" src="../_images/6d56b8907f7ce78a3421b48c4e892f0aa5f7f14c989b33545109453d5aa4f138.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sims_hist</span><span class="p">[:,:]</span><span class="o">.</span><span class="n">T</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/da6f4320b1a4921119a371e22609d7a6318eada150a16afe22614593c3bd8ad2.png" src="../_images/da6f4320b1a4921119a371e22609d7a6318eada150a16afe22614593c3bd8ad2.png" />
</div>
</div>
<p>This algorithm, however, has all sorts of issues. First, it is very sensitive to the correct bandwidth parameter for the classifier. If the bandwidth parameter is too small then points in the same class will be allocated to new classes. Second, it also depends on the assumption that the classes are gaussian distributed, and would have a hard time with other types of data distributions.</p>
</section>
<section id="vfa-encoding-with-sparse-block-codes">
<h2>VFA encoding with sparse block codes<a class="headerlink" href="#vfa-encoding-with-sparse-block-codes" title="Link to this heading">#</a></h2>
<p>In the VFA paper, we explain how then the Bochner theorm determines the kernel shape, and that you can create a lot of different types of kernel shapes that might be relevant. Some notable examples, if the probability distribution of the phases are discrete, then you can create a kernel that also has a circular topology, as well, by sampling from a discrete two-dimensional distribution, one can create kernel shapes like a hexagonal grid that resembles grid cells in neuroscience.</p>
<p>But what’s important for this thread is the connection between the VSAs that can be utilized to extend VFA. From our capacity paper, and ultimately stemming from the law of large numbers, the random distributions that different flavors of VSAs utilize do not change much the properties of the encoding.</p>
<p>If we can connect then VFA to other flavors of VSA, then we could take advantage of the alternative implementations for gains in efficiency on hardware, especially if we can utilize sparse and discrete representations.</p>
<p>So then can we extend VFA and the idea of the exponentiation trick/fractional binding to other flavors of VSA?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## lets do something similar with sparse block code</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">d</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># codevectors for the two dimensions</span>
<span class="n">vX</span> <span class="o">=</span> <span class="n">lccvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vY</span> <span class="o">=</span> <span class="n">lccvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">sdata_vecs</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">crvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">sdata_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lccbind</span><span class="p">(</span><span class="n">vX</span><span class="p">,</span> <span class="n">vY</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">beta</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">svfa_sims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">sdata_vecs</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">sdata_vecs</span><span class="p">[</span><span class="n">sidx</span><span class="p">,:])))</span><span class="o">/</span><span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">svfa_sims</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">sidx</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x169e5fee0&gt;
</pre></div>
</div>
<img alt="../_images/3d0b33c2500aef59a6da6cc4a583631fb24b7376a4a02edcd387947430f237dd.png" src="../_images/3d0b33c2500aef59a6da6cc4a583631fb24b7376a4a02edcd387947430f237dd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">kernel_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_samples</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">xv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_samples</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">yv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_samples</span><span class="p">):</span>
        
        <span class="n">vv</span> <span class="o">=</span> <span class="n">lccbind</span><span class="p">(</span><span class="n">vX</span><span class="p">,</span> <span class="n">vY</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">beta</span><span class="o">*</span><span class="n">xv</span><span class="p">,</span> <span class="n">beta</span><span class="o">*</span><span class="n">yv</span><span class="p">)</span>
        
        <span class="n">kernel_image</span><span class="p">[</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">sdata_vecs</span><span class="p">[</span><span class="n">sidx</span><span class="p">,:]),</span> <span class="n">vv</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im_extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">kernel_image</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">im_extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x169ebbc10&gt;
</pre></div>
</div>
<img alt="../_images/ad20630b2a8f4261b5e0afe1a3d4edce92cc964ccfd267ae5c2e9dc0ccd2cef3.png" src="../_images/ad20630b2a8f4261b5e0afe1a3d4edce92cc964ccfd267ae5c2e9dc0ccd2cef3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># So if we look at the values of the random fourier features, they are very dense</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># feature vector for one sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x169f14820&gt;]
</pre></div>
</div>
<img alt="../_images/6ffd2a084c896164aeda2cc2bebc26968cc8982d840194e4f3baa9336ea523c8.png" src="../_images/6ffd2a084c896164aeda2cc2bebc26968cc8982d840194e4f3baa9336ea523c8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># But of course the feature vectors for the block code are K sparse -ish</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sdata_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sdata_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sdata_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x169fba1f0&gt;]
</pre></div>
</div>
<img alt="../_images/f5a0f952fa51b0b69d56b856eeef67e2e7763dd4586a822bf243b3af4849b19a.png" src="../_images/f5a0f952fa51b0b69d56b856eeef67e2e7763dd4586a822bf243b3af4849b19a.png" />
</div>
</div>
<p>What we can see is that by translating the exponentiation trick into a different VSA flavor, we can still get the same kernel effects.</p>
<p>We can see that the sparse phasor block code used here works, but the vectors are close to sparse, but not perfect. How does the performance interact with discretization? Can we design and optimize a more ideal randomized representation for Loihi 2?</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="vsa_data_classifier.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data classification and Vector Function Architectures</p>
      </div>
    </a>
    <a class="right-next"
       href="vfa_ho_class-230426.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Classificaiton with high-order features</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-classification">Linear classification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-kernel-trick-turning-distance-into-dot-product">The kernel trick: turning distance into dot product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-similar-are-vfa-and-rff">How similar are VFA and RFF?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continual-learning">Continual Learning?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vfa-encoding-with-sparse-block-codes">VFA encoding with sparse block codes</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr. E. Paxon Frady
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>